{% extends 'base.html' %}
{% block title %}Filter Records{% endblock %}
{% block body %}

<div id="spinner-overlay" class="spinner-overlay">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>

<div class="jumbotron" style="background-color: beige;">
    <div class="container" style="width: 100%;">
        <div id="count-display" class="count-display container" style="width: 80%;">
            <!-- Counts will be displayed here -->
            <div class="row">
                <div class="col count-rows" style="float: left;">
                </div>
                <div class="row count-owners" style="float: right;">
                </div>
            </div>
        </div>
    </div>
    <div class="container filter-container"
        style="margin: 0 0; padding: 2vh 0; vertical-align: middle; text-align: center; max-width: 100%; width: 100%;">
        <form id="fetchRecordsForm" target="_blank">

            <!-- State, County, City -->
            <div class="row form-group" style="margin: 2vh 2vw; padding: 2vh 2vw; background-color: bisque;">
                <div class="col-md-2 property-state-div">

                    <label for="property-states"><b>Property State Name</b></label>


                    <select id="state" multiple size="5" name="property-states">
                        <!-- Options will be dynamically populated -->
                    </select>

                </div>
                <div class="col-md-2 property-county-div">

                    <label for="property-counties"><b>Property County Name</b></label>


                    <select id="county" multiple size="5" name="property-counties">
                        <!-- Options will be dynamically populated -->
                    </select>

                </div>
                <div class="col-md-2 property-city-div">

                    <label for="property-cities"><b>Property City Name</b></label>

                    <select id="city" multiple size="5" name="property-cities">
                        <!-- Options will be dynamically populated -->
                    </select>

                </div>

                <!-- Owner Name Type -->
                <div class="col-md-2">
                    <div class="owner-name-type-div container">
                        <label for="owner-name-type">
                            <b>Owner Name Type</b>
                        </label>
                        <select name="owner-name-type" id="owner-name-type" class="form-control" multiple size="5">
                            <option value="all">All</option>
                        </select>
                    </div>
                </div>

                <!-- Zip Code Matching -->
                <div class="col-md-2">
                    <div class="zip-code-matching-div container">
                        <label for="zip-code-matching">
                            <b>Zip Code Matching</b>
                        </label>
                        <select name="zip-code-matching" id="zip-code-matching" size="5" class="form-control">
                            <option value="all">All</option>
                            <option value="True">True</option>
                            <option value="False">False</option>
                        </select>
                    </div>
                </div>

                <!-- Lot Acreage -->
                <div class="col-md-2">
                    <div class="lot_acreage-div container">

                        <label for="lot_acreage-min">
                            <b>Lot Acreage</b>
                        </label>
                        <input type="number" name="lot_acreage-min" id="lot_acreage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="lot_acreage-max" id="lot_acreage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Significant Flood Zones -->
                <div class="col-md-2">
                    <div class="significant_flood_zones-div container">

                        <label for="significant_flood_zones-min">Significant Flood Zones</label>


                        <input type="number" name="significant_flood_zones-min" id="significant_flood_zones-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="significant_flood_zones-max" id="significant_flood_zones-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Slope Mean -->
                <div class="col-md-2">
                    <div class="slope_mean-div container">

                        <label for="slope_mean-min">Slope Mean</label>

                        <input type="number" name="slope_mean-min" id="slope_mean-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="slope_mean-max" id="slope_mean-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Nearest Road Type -->
                <div class="col-md-2">
                    <div class="nearest_road_types-div container">

                        <label for="nearest_road_types">Nearest Road Type</label>

                        <select name="nearest_road_types" id="nearest_road_types" class="form-control" multiple size="5"
                            style="width: 100%;">
                            <option value="all">Select All</option>
                            <!-- Options will be dynamically populated by JavaScript -->
                        </select>

                    </div>
                </div>

                <!-- Distance to Nearest Road from Centroid -->
                <div class="col-md-2">
                    <div class="distance_to_nearest_road_from_centroid-div container">

                        <label for="distance_to_nearest_road_from_centroid-min">Distance to Nearest Road (from
                            centroid)</label>

                        <input type="number" name="distance_to_nearest_road_from_centroid-min"
                            id="distance_to_nearest_road_from_centroid-min" class="form-control" placeholder="Min"
                            style="width: 100%;">
                        <input type="number" name="distance_to_nearest_road_from_centroid-max"
                            id="distance_to_nearest_road_from_centroid-max" class="form-control" placeholder="Max"
                            style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Road Frontage -->
                <div class="col-md-2">
                    <div class="road-frontage-div container">

                        <label for="road-frontage-min">Road Frontage</label>

                        <input type="number" name="road-frontage-min" id="road-frontage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="road-frontage-max" id="road-frontage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Trees Percentage -->
                <div class="col-md-2">
                    <div class="trees_percentage-div container">

                        <label for="trees_percentage-min">Trees Percentage</label>


                        <input type="number" name="trees_percentage-min" id="trees_percentage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="trees_percentage-max" id="trees_percentage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Built Percentage -->
                <div class="col-md-2">
                    <div class="built_percentage-div container">

                        <label for="built_percentage-min">Built Percentage</label>


                        <input type="number" name="built_percentage-min" id="built_percentage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="built_percentage-max" id="built_percentage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Grass Percentage -->
                <div class="col-md-2">
                    <div class="grass_percentage-div container">

                        <label for="grass_percentage-min">Grass Percentage</label>

                        <input type="number" name="grass_percentage-min" id="grass_percentage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="grass_percentage-max" id="grass_percentage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Crops Percentage -->
                <div class="col-md-2">
                    <div class="crops_percentage-div container">

                        <label for="crops_percentage-min">Crops Percentage</label>

                        <input type="number" name="crops_percentage-min" id="crops_percentage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="crops_percentage-max" id="crops_percentage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Shrub and Scrub Percentage -->
                <div class="col-md-2">
                    <div class="shrub_and_scrub_percentage-div container">

                        <label for="shrub_and_scrub_percentage-min">Shrub and Scrub Percentage</label>

                        <input type="number" name="shrub_and_scrub_percentage-min" id="shrub_and_scrub_percentage-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="shrub_and_scrub_percentage-max" id="shrub_and_scrub_percentage-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Bare Percentage -->
                <div class="col-md-2">
                    <div class="bare_percentage-div container">

                        <label for="bare_percentage-min">Bare Percentage</label>

                        <input type="number" name="bare_percentage-min" id="bare_percentage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="bare_percentage-max" id="bare_percentage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Water Percentage -->
                <div class="col-md-2">
                    <div class="water_percentage-div container">

                        <label for="water_percentage-min">Water Percentage</label>

                        <input type="number" name="water_percentage-min" id="water_percentage-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="water_percentage-max" id="water_percentage-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Flooded Vegetation Percentage -->
                <div class="col-md-2">
                    <div class="flooded_vegetation_percentage-div container">

                        <label for="flooded_vegetation_percentage-min">Flooded Vegetation Percentage</label>

                        <input type="number" name="flooded_vegetation_percentage-min"
                            id="flooded_vegetation_percentage-min" class="form-control" placeholder="Min"
                            style="width: 100%;">
                        <input type="number" name="flooded_vegetation_percentage-max"
                            id="flooded_vegetation_percentage-max" class="form-control" placeholder="Max"
                            style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Snow and Ice Percentage -->
                <div class="col-md-2">
                    <div class="snow_and_ice_percentage-div container">

                        <label for="snow_and_ice_percentage-min">Snow and Ice Percentage</label>

                        <input type="number" name="snow_and_ice_percentage-min" id="snow_and_ice_percentage-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="snow_and_ice_percentage-max" id="snow_and_ice_percentage-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Parcel Area -->
                <div class="col-md-2">
                    <div class="parcel_area-div container">

                        <label for="parcel_area-min">Parcel Area</label>

                        <input type="number" name="parcel_area-min" id="parcel_area-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="parcel_area-max" id="parcel_area-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Largest Rectangle Area -->
                <div class="col-md-2">
                    <div class="largest_rect_area-div container">

                        <label for="largest_rect_area-min">Largest Rectangle Area</label>

                        <input type="number" name="largest_rect_area-min" id="largest_rect_area-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="largest_rect_area-max" id="largest_rect_area-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Percent Rectangle -->
                <div class="col-md-2">
                    <div class="percent_rectangle-div container">

                        <label for="percent_rectangle-min">Percent Rectangle</label>

                        <input type="number" name="percent_rectangle-min" id="percent_rectangle-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="percent_rectangle-max" id="percent_rectangle-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Largest Square Area -->
                <div class="col-md-2">
                    <div class="largest_square_area-div container">

                        <label for="largest_square_area-min">Largest Square Area</label>

                        <input type="number" name="largest_square_area-min" id="largest_square_area-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="largest_square_area-max" id="largest_square_area-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Percent Square -->
                <div class="col-md-2">
                    <div class="percent_square-div container">

                        <label for="percent_square-min">Percent Square</label>

                        <input type="number" name="percent_square-min" id="percent_square-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="percent_square-max" id="percent_square-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Largest Rectangle Area Cleaned -->
                <div class="col-md-2">
                    <div class="largest_rect_area_cleaned-div container">

                        <label for="largest_rect_area_cleaned-min">Largest Rectangle Area Cleaned</label>

                        <input type="number" name="largest_rect_area_cleaned-min" id="largest_rect_area_cleaned-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="largest_rect_area_cleaned-max" id="largest_rect_area_cleaned-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Largest Square Area Cleaned -->
                <div class="col-md-2">
                    <div class="largest_square_area_cleaned-div container">

                        <label for="largest_square_area_cleaned-min">Largest Square Area Cleaned</label>

                        <input type="number" name="largest_square_area_cleaned-min" id="largest_square_area_cleaned-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="largest_square_area_cleaned-max" id="largest_square_area_cleaned-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">

                    </div>
                </div>

                <!-- Wetlands Total -->

                <div class="col-md-2">
                    <div class="Wetlands_Total-div container">
                        <label for="wetlands_total-min">Wetlands Total</label>

                        <input type="number" name="wetlands_total-min" id="wetlands_total-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="wetlands_total-max" id="Wetlands_Total-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>




            </div>
            <div class="row form-group" style="margin: 2vg, 2vw; padding: 2vh 2vw; background-color: bisque;">
                <!-- Building_square_footage -->
                <div class="col-md-2">
                    <div class="building_square_footage-div container">
                        <label for="building_square_footage-min">Building_square_footage</label>
                        <input type="number" name="building_square_footage-min" id="building_square_footage_max-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="building_square_footage-max" id="building_square_footage_max-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Clay -->
                <div class="col-md-2">
                    <div class="clay-div container">
                        <label for="clay-min">Clay</label>
                        <input type="number" name="clay-min" id="clay-min" class="form-control" placeholder="Min"
                            style="width: 100%;">
                        <input type="number" name="clay-max" id="clay-max" class="form-control" placeholder="Max"
                            style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Clay_loam -->
                <div class="col-md-2">
                    <div class="clay_loam-div container">
                        <label for="clay_loam-min">Clay_loam</label>
                        <input type="number" name="clay_loam-min" id="clay_loam-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="clay_loam-max" id="clay_loam-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Coarse_sand -->
                <div class="col-md-2">
                    <div class="coarse_sand-div container">
                        <label for="coarse_sand-min">Coarse_sand</label>
                        <input type="number" name="coarse_sand-min" id="coarse_sand-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="coarse_sand-max" id="coarse_sand-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Coarse_sandy_loam -->
                <div class="col-md-2">
                    <div class="coarse_sandy_loam-div container">
                        <label for="coarse_sandy_loam-min">Coarse_sandy_loam</label>
                        <input type="number" name="coarse_sandy_loam-min" id="coarse_sandy_loam-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="coarse_sandy_loam-max" id="coarse_sandy_loam-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Fine_sand -->
                <div class="col-md-2">
                    <div class="fine_sand-div container">
                        <label for="fine_sand-min">Fine_sand</label>
                        <input type="number" name="fine_sand-min" id="fine_sand-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="fine_sand-max" id="fine_sand-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Fine_sandy_loam -->
                <div class="col-md-2">
                    <div class="fine_sandy_loam-div container">
                        <label for="fine_sandy_loam-min">Fine_sandy_loam</label>
                        <input type="number" name="fine_sandy_loam-min" id="fine_sandy_loam-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="fine_sandy_loam-max" id="fine_sandy_loam-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Largest_building -->
                <div class="col-md-2">
                    <div class="largest_building-div container">
                        <label for="largest_building-min">Largest_building</label>
                        <input type="number" name="largest_building-min" id="largest_building-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="largest_building-max" id="largest_building-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>
                <!-- Loam -->
                <div class="col-md-2">
                    <div class="loam-div container">
                        <label for="loam-min">Loam</label>
                        <input type="number" name="loam-min" id="loam-min" class="form-control" placeholder="Min"
                            style="width: 100%;">
                        <input type="number" name="loam-max" id="loam-max" class="form-control" placeholder="Max"
                            style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Loamy_coarse_sand -->
                <div class="col-md-2">
                    <div class="loamy_coarse_sand-div container">
                        <label for="loamy_coarse_sand-min">Loamy_coarse_sand</label>
                        <input type="number" name="loamy_coarse_sand-min" id="loamy_coarse_sand-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="loamy_coarse_sand-max" id="loamy_coarse_sand-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Loamy_fine_sand -->
                <div class="col-md-2">
                    <div class="loamy_fine_sand-div container">
                        <label for="loamy_fine_sand-min">Loamy_fine_sand</label>
                        <input type="number" name="loamy_fine_sand-min" id="loamy_fine_sand-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="loamy_fine_sand-max" id="loamy_fine_sand-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Loamy_sand -->
                <div class="col-md-2">
                    <div class="loamy_sand-div container">
                        <label for="loamy_sand-min">Loamy_sand</label>
                        <input type="number" name="loamy_sand-min" id="loamy_sand-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="loamy_sand-max" id="loamy_sand-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>
                <!-- Lot_area -->
                <div class="col-md-2">
                    <div class="lot_area-div container">
                        <label for="lot_area-min">Lot_area</label>
                        <input type="number" name="lot_area-min" id="lot_area-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="lot_area-max" id="lot_area-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Num_buildings -->
                <div class="col-md-2">
                    <div class="num_buildings-div container">
                        <label for="num_buildings-min">Num_buildings</label>
                        <input type="number" name="num_buildings-min" id="num_buildings-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="num_buildings-max" id="num_buildings-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Percent_rectangle_area_cleaned -->
                <div class="col-md-2">
                    <div class="percent_rectangle_area_cleaned-div container">
                        <label for="percent_rectangle_area_cleaned-min">Percent_rectangle_area_cleaned</label>
                        <input type="number" name="percent_rectangle_area_cleaned-min"
                            id="percent_rectangle_area_cleaned-min" class="form-control" placeholder="Min"
                            style="width: 100%;">
                        <input type="number" name="percent_rectangle_area_cleaned-max"
                            id="percent_rectangle_area_cleaned-max" class="form-control" placeholder="Max"
                            style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Percent_square_area_cleaned -->
                <div class="col-md-2">
                    <div class="percent_square_area_cleaned-div container">
                        <label for="percent_square_area_cleaned-min">Percent_square_area_cleaned</label>
                        <input type="number" name="percent_square_area_cleaned-min" id="percent_square_area_cleaned-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="percent_square_area_cleaned-max" id="percent_square_area_cleaned-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Sand -->
                <div class="col-md-2">
                    <div class="sand-div container">
                        <label for="sand-min">Sand</label>
                        <input type="number" name="sand-min" id="sand-min" class="form-control" placeholder="Min"
                            style="width: 100%;">
                        <input type="number" name="sand-max" id="sand-max" class="form-control" placeholder="Max"
                            style="width: 100%; margin-top: 8px;">
                    </div>
                </div>



                <!-- Sandy_clay -->
                <div class="col-md-2">
                    <div class="sandy_clay-div container">
                        <label for="sandy_clay-min">Sandy_clay</label>
                        <input type="number" name="sandy_clay-min" id="sandy_clay-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="sandy_clay-max" id="sandy_clay-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Sandy_clay_loam -->
                <div class="col-md-2">
                    <div class="sandy_clay_loam-div container">
                        <label for="sandy_clay_loam-min">Sandy_clay_loam</label>
                        <input type="number" name="sandy_clay_loam-min" id="sandy_clay_loam-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="sandy_clay_loam-max" id="sandy_clay_loam-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Sandy_loam -->
                <div class="col-md-2">
                    <div class="sandy_loam-div container">
                        <label for="sandy_loam-min">Sandy_loam</label>
                        <input type="number" name="sandy_loam-min" id="sandy_loam-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="sandy_loam-max" id="sandy_loam-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Silt_loam -->
                <div class="col-md-2">
                    <div class="silt_loam-div container">
                        <label for="silt_loam-min">Silt_loam</label>
                        <input type="number" name="silt_loam-min" id="silt_loam-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="silt_loam-max" id="silt_loam-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Silty_clay -->
                <div class="col-md-2">
                    <div class="silty_clay-div container">
                        <label for="silty_clay-min">Silty_clay</label>
                        <input type="number" name="silty_clay-min" id="silty_clay-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="silty_clay-max" id="silty_clay-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>
                <!-- Silty_clay_loam -->
                <div class="col-md-2">
                    <div class="silty_clay_loam-div container">
                        <label for="silty_clay_loam-min">Silty_clay_loam</label>
                        <input type="number" name="silty_clay_loam-min" id="silty_clay_loam-min" class="form-control"
                            placeholder="Min" style="width: 100%;">
                        <input type="number" name="silty_clay_loam-max" id="silty_clay_loam-max" class="form-control"
                            placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Smallest_building -->
                <div class="col-md-2">
                    <div class="smallest_building-div container">
                        <label for="smallest_building-min">Smallest_building</label>
                        <input type="number" name="smallest_building-min" id="smallest_building-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="smallest_building-max" id="smallest_building-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

                <!-- Total_building_area -->
                <div class="col-md-2">
                    <div class="total_building_area-div container">
                        <label for="total_building_area-min">Total_building_area</label>
                        <input type="number" name="total_building_area-min" id="total_building_area-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="total_building_area-max" id="total_building_area-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>


                <!-- Very_fine_sandy_loam -->
                <div class="col-md-2">
                    <div class="very_fine_sandy_loam-div container">
                        <label for="very_fine_sandy_loam-min">Very_fine_sandy_loam</label>
                        <input type="number" name="very_fine_sandy_loam-min" id="very_fine_sandy_loam-min"
                            class="form-control" placeholder="Min" style="width: 100%;">
                        <input type="number" name="very_fine_sandy_loam-max" id="very_fine_sandy_loam-max"
                            class="form-control" placeholder="Max" style="width: 100%; margin-top: 8px;">
                    </div>
                </div>

            </div>


    </div>

    </form>


    <div class="center">
        <div class="row">
            <div class="col">
                <button type="button" id="property-count" class="property-count btn btn-primary btn-sm">Count
                    Properties</button>
            </div>
            <div class="col">
                <div class="container center" style="align-items: center; text-align: center;">
                    <button type="submit" id="fetch-results" class="btn btn-success btn-sm">
                        Fetch records
                    </button>
                </div>
            </div>
        </div>
    </div>

</div>
<div class="container" style="width: 100%;overflow-y: auto;">
    <div id="content"></div>
    <button style="display: none;" value="export" id="export">Export</button>
</div>
</div>





<script type="text/javascript" src="/static/js/jquery-2.2.4.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.multi-select.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
<script type="text/javascript">

    var select_type_fields = {
        "state": "Property_State_Name",
        "county": "Property_County_Name",
        "city": "Property_City",
        "property-access-type": "Access_Type",
        "property-zip-codes-match": "Zip_Code_Matching",
        "tree-coverage-select": "tree_coverage",
        "wells-select": "well",
        "owner-type-select": "Owner_Type",
    }

    var numeric_fields = {
        "lot-acreage": "Lot_Acreage",
        "floodzones": "Significant_Flood_Zones",
        "wetlands": "Wetlands_Total",
        "slopes": "slope_mean",
    }

    function formatOptionText(text) {
        // Title case conversion using regular expression
        return text.replace(/\w\S*/g, function (txt) { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });
    }
    function hideElementUsingClass(classValue) {
        $("." + classValue).hide()
    }

    function showElementUsingClass(classValue) {
        $("." + classValue).show()
    }

    var initialDataObject = {}; // Global variable to store initial data

    var FormItemsChanged = [];

    var global_states = []
    var global_counties = []
    var global_cities = []


    function populateFilterFields() {
        // Fetch filter values from "/get-filter-values"
        $.ajax({
            url: '/get-filter-values',
            dataType: 'json',
            success: function (response) {
                if (response && response.data) {
                    let selectFields = Object.keys(select_type_fields);
                    let numberFields = Object.keys(numeric_fields);

                    // Process each filter option
                    Object.keys(response.data).forEach((key) => {
                        let selectOptions = response.data[key];
                        let selectField = $(`select#${key}`);

                        // Handle select fields
                        if (selectFields.includes(key) && !key.includes('zip')) {
                            if (typeof selectOptions === 'object' && key === 'state') {
                                // Populate state options
                                selectField.empty().append('<option value="all">Select All</option>');
                                Object.keys(selectOptions).forEach(state => {
                                    selectField.append(`<option value="${state}">${state}</option>`);
                                });

                                selectField.show().parent().show().parent().show();

                                // Handle state-specific logic
                                selectField.on('change', function () {
                                    let selectedStates = $(this).val();
                                    let countySelectField = $('select#county');
                                    let citySelectField = $('select#city');

                                    countySelectField.empty().append('<option value="all">Select All</option>');
                                    citySelectField.empty().append('<option value="all">Select All</option>');

                                    if (Array.isArray(selectedStates) && selectedStates.length) {
                                        selectedStates.forEach(state => {
                                            if (state !== 'all' && selectOptions[state]) {
                                                Object.keys(selectOptions[state]).forEach(county => {
                                                    countySelectField.append(`<option value="${county}">${county}</option>`);
                                                });
                                            }
                                        });
                                    }

                                    countySelectField.show().parent().show().parent().show();

                                    // Handle county-specific logic
                                    countySelectField.on('change', function () {
                                        let selectedCounties = $(this).val();
                                        citySelectField.empty().append('<option value="all">Select All</option>');

                                        if (Array.isArray(selectedCounties) && selectedCounties.length) {
                                            selectedStates.forEach(state => {
                                                if (state !== 'all' && selectOptions[state]) {
                                                    selectedCounties.forEach(county => {
                                                        if (county !== 'all' && selectOptions[state][county]) {
                                                            selectOptions[state][county].forEach(city => {
                                                                citySelectField.append(`<option value="${city}">${city}</option>`);
                                                            });
                                                        }
                                                    });
                                                }
                                            });
                                        }

                                        citySelectField.show().parent().show().parent().show();
                                    });
                                });
                            } else if (Array.isArray(selectOptions)) {
                                let availableOptions = [...new Set(selectOptions.map(option => option[1]))].map(option => [option, option]);

                                selectField.empty().append('<option value="all">Select All</option>');

                                availableOptions.forEach(([value, text]) => {
                                    selectField.append(`<option value="${value}">${text}</option>`);
                                });

                                selectField.show().parent().show().parent().show();
                            }
                        }
                        // Handle numeric fields
                        else if (numberFields.includes(key) && !key.includes('price')) {
                            let val = response.data[key] || {};
                            let min = Math.floor(val.min) || 0;
                            let max = Math.ceil(val.max) || 999999;

                            let minInput = $(`input#${key}-min`);
                            let maxInput = $(`input#${key}-max`);

                            minInput.attr({
                                'min': min,
                                'max': max,
                                'title': `Min: ${min}, Max: ${max}`,
                            }).val(min).show().parent().show().parent().show();

                            maxInput.attr({
                                'min': min,
                                'max': max,
                                'title': `Min: ${min}, Max: ${max}`,
                            }).val(max).show().parent().show().parent().show();
                        }
                        // Handle nearest_road_type field
                        else if (key === 'nearest_road_types') {
                            if (Array.isArray(selectOptions)) {
                                let availableOptions = [...new Set(selectOptions.map(option => option))].map(option => [option, option]);

                                selectField.empty().append('<option value="all">Select All</option>');

                                availableOptions.forEach(([value, text]) => {
                                    selectField.append(`<option value="${value}">${text}</option>`);
                                });

                                selectField.show().parent().show().parent().show();
                            }
                        } else {
                            console.warn('Field not handled:', key);
                        }
                    });
                } else {
                    console.error('Response data is missing or invalid:', response);
                }
            },
            error: function (error) {
                console.error('Error fetching filter values:', error);
            }
        });
    }

    function populateNumericFilters() {
        $.ajax({
            url: '/get-numeric-filters',
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                if (data.message === 'success') {
                    const results = data.data;
                    let missed = [];

                    $.each(results, function (key, value) {
                        const $inputElement = $(`input[name="${key}"]`);


                        if ($inputElement.length) {
                            $inputElement.val(value);
                        } else {
                            // console.log($inputElement, " ", key);

                            if (key === "significant_flood_zones-min") {
                                console.log('pr$inputElement', key)
                            }


                            missed.push(key);
                        }

                    });
                    console.log(missed);
                } else {
                    console.error('Failed to fetch numeric filter values:', data.message);
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.error('Error fetching numeric filter values:', textStatus, errorThrown);
            }
        });
    }

    $(document).ready(function () {
        populateNumericFilters();

        hideElementUsingClass('property-state-div')
        hideElementUsingClass('property-county-div');
        hideElementUsingClass('property-city-div');
        hideElementUsingClass('property-access-type-div');
        hideElementUsingClass('property-zip-codes-match-div');
        hideElementUsingClass('property-owner-do-not-mail-div');
        hideElementUsingClass('lot-acreage-div');
        hideElementUsingClass('market-price-div');
        hideElementUsingClass('tree-coverage-div');
        hideElementUsingClass('well-select-div');
        hideElementUsingClass('owner-type-div');
        hideElementUsingClass('floodzones-div');
        hideElementUsingClass('wetlands-div');
        hideElementUsingClass('slopes-div');
        hideElementUsingClass('count-display');
        $('#property-count').hide();
        $('#fetch-results').hide();



        console.info("called filter fields populator. showing btns");

        $('#property-count').show();
        $('#fetch-results').show();

        populateFilterFields();

        $('select').on('change', function () {
            let name = $(this).attr('name')
            FormItemsChanged.push(name)
        })


        $('input').on('change', function () {
            let name = $(this).attr('name')
            FormItemsChanged.push(name)
        })

        // Function to capture initial form data
        function captureInitialData() {
            var formData = $('#fetchRecordsForm').serializeArray();
            $.each(formData, function (i, field) {
                initialDataObject[field.name] = field.value;
            });

            console.log('initalformadata ', initialDataObject)
        }

        captureInitialData()

        // Function to get changed fields
        function getChangedFields() {
            var formData = $('#fetchRecordsForm').serializeArray();

            // Create a map to hold the form data with proper handling for multiselect fields
            var fieldMap = {};



            // Iterate through the serialized array and build the field map
            $.each(formData, function (i, field) {

                console.warn(field.name, " ", field.value)

                if (field.name && FormItemsChanged.includes(field.name) && !field.name.includes('price') && !field.name.includes('zip')) {

                    if (select_type_fields.hasOwnProperty(field.name) || ['property-counties', 'property-states', 'property-cities', 'property-access-type', 'property-zip-code-match', 'nearest_road_types'].includes(field.name)) {
                        console.log('type select ', field.name)


                        if (fieldMap.hasOwnProperty(field.name)) {
                            fieldMap[field.name].push(field.value)

                        } else {
                            fieldMap[field.name] = []
                            // if (field.value != 'all') {
                            fieldMap[field.name].push(field.value);
                            // } else {
                            //     delete fieldMap[field.name]
                            // }
                        }

                    }
                    else {
                        let field_name = ''



                        if (field.name.toString().includes('-min')) {
                            field_name = field.name.toString().replace(/-min$/, '');

                            if (!fieldMap.hasOwnProperty(field_name)) {
                                fieldMap[field_name] = {}
                            }
                            fieldMap[field_name]['min'] = field.value
                        } else if (field.name.toString().includes('max')) {
                            field_name = field.name.toString().replace(/-max$/, '');
                            if (!fieldMap.hasOwnProperty(field_name)) {
                                fieldMap[field_name] = {}
                            }
                            fieldMap[field_name]['max'] = field.value
                        }

                        console.log('field name numeric is', field_name)

                    }
                }
                else {

                }

            });

            return fieldMap;
        }

        $("button.property-count").click(function () {
            console.log("property count clicked");
            var dataObject = getChangedFields();
            console.log('Changed dataObject', dataObject);

            // Show the spinner and blur the page
            // $('#spinner-overlay').css('display', 'flex');
            // $('body').addClass('blur');


            $.ajax({
                url: '/get-counts',
                type: 'POST',
                data: JSON.stringify(dataObject),
                contentType: 'application/json',
                success: function (response) {
                    // console.log(response);

                    if (response && typeof response == 'object' && response.hasOwnProperty('message') && response.hasOwnProperty('count') && response.message.toString().toLowerCase() == 'success' && typeof response.count == 'object' && response.count.hasOwnProperty('all_rows') && response.count.hasOwnProperty('distinct_owners')) {
                        console.log(response.count)
                        let count = response.count;
                        console.log('success')
                        $('.count-rows').empty()
                        $('.count-rows').append(`<span><b>No. of Properties: </b>${count.all_rows}</span>`)
                        $('.count-owners').empty()
                        $('.count-owners').append(`<span><b>No. of Distinct Owners: </b>${count.distinct_owners}</span>`)

                        showElementUsingClass('count-display');
                    } else {
                        console.error(response);
                        console.error(response.count.hasOwnProperty('all_rows'));
                        console.error(response.count.hasOwnProperty('distinct_owners'));
                        hideElementUsingClass('count-display');
                    }
                    $('#spinner-overlay').css('display', 'none');


                },
                error: function (error) {
                    console.error('Error fetching counts:', error);
                    $('#spinner-overlay').css('display', 'none');

                }
            })
        });

        $('#fetch-results').click(function () {
            // send ajax request to export_data URL

            var dataObject = getChangedFields();
            console.log('Changed dataObject', JSON.stringify(dataObject));
            $('#spinner-overlay').css('display', 'flex');

            $.ajax({
                url: '/get-records',
                type: 'POST',
                data: JSON.stringify(dataObject),
                contentType: 'application/json',
                success: function (response) {

                    $('#spinner-overlay').css('display', 'none');
                    // $('#content').html(response.html);
                    //  $('button#export').prop('disabled', false);
                    // $('button#export').css('display', 'flex');

                    //$('button#export').on('click', function () {
                    //  console.log('export data object ', dataObject);

                    // $.ajax({
                    //   url: "/start-export-records",
                    // type: 'POST',
                    //data: JSON.stringify(dataObject),
                    //contentType: 'application/json',
                    //success: function (response) {
                    //   console.log(response)

                    //},
                    //error: function (error) {
                    //  console.error(error);
                    //console.error(' while exporting records');
                    //}
                    //})
                    //})

                    // Handle success
                    window.location.href = '/view-records';  // Redirect on success

                },
                error: function (error) {
                    console.error('Error submitting form:', error);
                    $('#spinner-overlay').css('display', 'none');

                }
            });

            // $(this).prop('disabled', true);  //Disable the button
            // setTimeout(function () {
            //     $('#fetch-results').prop('disabled', false);  //Enable the button after 3 hours
            // }, 3 * 60 * 60 * 1000);  //3 hours in milliseconds
        });




    });
</script>

{% endblock %}